{% extends "base.html" %}

{% block title %}{{ object.get_verbose_name.grandprix }} {{ object.grandprix.name }} {{ object.grandprix.season.year }} | F1Online.Ru{% endblock %}
{% block title_wrap %}{% endblock %}

{% block content %}  
    <h2>{{ object.get_verbose_name.grandprix }} {{ object.grandprix.name }} {{ object.grandprix.season.year }}</h2>
    <div>{{ object.get_verbose_name.date }}: {{ object.date|date:"d.m.Y" }}</div>
    <div>{{ object.grandprix.tracklen.track }}</div>
    <div>{{ object.grandprix.tracklen.get_verbose_name.length }}: {{ object.grandprix.tracklen.length }}</div>
    <div>{{ object.get_verbose_name.laps }} : {{ object.laps }}</div>
    <h3>{{ object.get_type_display }}</h3>
    
    {% for result in object.get_results %}
    {% if forloop.first %}
    <table class="heat-detail">
        <tr>
            <th>{{ result.get_verbose_name.position }}</th>
            <th>{{ result.get_verbose_name.racer }}</th>
            <th>{{ result.get_verbose_name.team }}</th>
            <th>{{ result.get_verbose_name.engine }}</th>
            <th>{{ result.get_verbose_name.tyre }}</th>
            <th>{{ result.get_verbose_name.get_time_display }}</th>
            <th>{{ result.get_verbose_name.get_delta_display }}</th>
        </tr>
    {% endif %}
        <tr>
            {% if result.is_classified %}
                {% if result.dsq %}
            		<td class="center nc">DSQ</td>
           		{% else %}
                	<td class="center">{{ result.position }}</td>
               	{% endif %}
            {% else %}
               	<td class="center nc">NC</td>
            {% endif %}
            <td><a href="{% url racer_detail result.racer.id %}">{{ result.racer }}</a></td>
            <td>{{ result.team }}</td>
            <td>{{ result.engine }}</td>
            <td class="center"><img src="/media/upload/tyre/{{ result.tyre|lower }}.png" alt="{{ result.tyre }}"/></td>
            <td>{{ result.get_time_display }}</td>
            <td>{{ result.get_delta_display }}</td>
            <td>{{ result.fail }}</td>
        </tr>
    {% endfor %}
	<tr>
		<td colspan="7"><h4>Не классифицированы</h4></td>
	</tr>
    {% for result in object.get_fails %}
        <tr>
            {% if result.is_classified %}
                {% if result.dsq %}
            		<td class="center nc">DSQ</td>
           		{% else %}
                	<td class="center">{{ result.position }}</td>
               	{% endif %}
            {% else %}
            	{% if result.dsq %}
            		<td class="center nc">DSQ</td>
           		{% else %}
                	<td class="center nc">NC</td>
               	{% endif %}
            {% endif %}
            <td><a href="{% url racer_detail result.racer.id %}">{{ result.racer }}</a></td>
            <td>{{ result.team }}</td>
            <td>{{ result.engine }}</td>
            <td class="center"><img src="/media/upload/tyre/{{ result.tyre|lower }}.png" alt="{{ result.tyre }}"/></td>
            <td>{{ result.get_lap_display }}</td>
            <td>{{ result.fail }}</td>
        </tr>
    {% endfor %}
    </table>
    
    {% for best in object.bests.all %}
        {{ best.result.racer }}
        {{ best.lap }}
        {{ best.get_time_display }}
    {% endfor %}
{% endblock %}
